var config = require('mcp_config');
var ec = config.ec;

var CheckService = function () {
};

CheckService.prototype.checkTableColumn = function (table, columns, cb) {

    if (columns == null || columns == undefined) {
        cb(null);
        return;
    }
    for (var col in columns) {
        var temp = false;
        var conditionArray = col.match(/\$([a-z]+)/);
        if (!conditionArray) {
            for (var key in table.colList) {
                if (col == key) {
                    temp = true;
                    break;
                }
            }
            if (!temp) {
                console.log("错误字段："+col);
                cb(ec.E3010);
                return;
            }
        }else{
            var keyData = columns[col];
            for(var _index in keyData){
                var keyDataObj=keyData[_index];
                for(var colName in keyDataObj){
                    for (var key in table.colList) {
                        if (colName == key) {
                            temp = true;
                            break;
                        }
                    }
                    if (!temp) {
                        console.log("错误字段："+col);
                        cb(ec.E3010);
                        return;
                    }
                }
            }
        }
    }
    cb(null);

};

var checkService = new CheckService();
module.exports = checkService;