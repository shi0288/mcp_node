var dc = require('mcp_db').dc;
var config = require('mcp_config');
var ec = config.ec;
var prop = config.prop;

var DigestService = function(){};

/**
 * @param fromType
 */
DigestService.prototype.getKey = function(info, cb)
{
    if(info.fromType == prop.digestFromType.DB)
    {
        var customerTab = dc.mg.get("customer");
        customerTab.findOne({userId:info.userId, type:info.userType}, {}, [], function(err, data){
            if(err)
            {
                cb(ec.E9999);
            }
            else
            {
                if(data)
                {
                    cb(null, data.st);
                }
                else
                {
                    cb(ec.E0002);
                }
            }
        });
    }
    else
    {
        cb(ec.E9000);
    }
};

module.exports = new DigestService();